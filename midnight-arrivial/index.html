<!DOCTYPE html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>Midnight Arrival</title>
  <meta name="description" content="">

  <link rel="canonical" href="https://moriartynaps.org/midnight-arrivial/">
  <link rel="alternate" type="application/rss+xml" title="MoriartyNaps" href="https://moriartynaps.org/feed.xml">
  <link href="https://fonts.googleapis.com/css?family=Crimson+Text|Quicksand|Proza+Libre|Averia+Serif+Libre|Oleo+Script|Maven+Pro" rel="stylesheet">

  <link rel="stylesheet" href="/assets/styles/main-a78c22e7cb.css">

  <link rel="apple-touch-icon" sizes="57x57" href="/assets/graphics/favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/graphics/favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/graphics/favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/graphics/favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/graphics/favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/graphics/favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/graphics/favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/graphics/favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/graphics/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/graphics/favicon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/graphics/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/graphics/favicon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/graphics/favicon/favicon-16x16.png">
  <link rel="manifest" href="/assets/graphics/favicon/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/graphics/favicon/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff"> 

  
    <meta property="og:title" content="Midnight Arrival" />
  

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@DylanMoriarty">
  <meta name="twitter:creator" content="@DylanMoriarty">
  <meta name="twitter:title" content="Midnight Arrival">

  
    <meta name="twitter:description" content="A calm descent over the flickering night lights of Washington D.C.">
    <meta property="og:description" content="A calm descent over the flickering night lights of Washington D.C." />
  

  
    <meta property="og:url"         content="https://moriartynaps.org/maps-of-home/" />
  
  <meta property="og:type"        content="article" />
  <meta property="og:title"       content="Midnight Arrival" />
  <meta property="og:image"       content="https://moriartynaps.org/assets/graphics/posts/15-midnight-arrival/soc-img.jpg" />

  <meta name="twitter:image" content="https://moriartynaps.org/assets/graphics/posts/15-midnight-arrival/twi-img.jpg">
</head>


<h1 class="site-title"><a href="../" class="no_underline">Moriarty Naps</a></h1>

<div class="site-home">
  
<div class="nav-container nav-container__right">
	<div class="nav-musicBox">
		<iframe width="100%" height="200" src="https://www.youtube.com/embed/videoseries?list=PL1KbmvLItolR5ECJKKSHAWymes57Ry4n5" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
	</div>

	<div class="nav-container__tunes">
    
      <img src="../assets/graphics/posts/music-box-i.gif" class="music-box-gif music-box-gif_left" />
      <i>Hover for Companion tunes</i>
      <img src="../assets/graphics/posts/music-box-ri.gif" class="music-box-gif music-box-gif_right" />
    
	</div>
</div>




  <link href="https://api.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.js"></script>





  <script src='https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/noframework.waypoints.min.js'></script>






<section class="article-container">

  <div class="article-gutter "></div>

  <article class="article-content ">
    <div class="article-header">
      <div class="article-back"><a href="../" class="no_underline">&larr; back</a></div>
      <h3 class="">Midnight Arrival</h3>
    </div>

    <style>
  body {
    background-color: #000;
    background: #000;
  }

  article a { color: #e5c53e; }
  article a:hover { 
      color: darken(#e5c53e, 20);
      opacity: 0.8;
  }
  a:active { color: darken(#e5c53e, 20); }
  a:visited { color: #e5c53e; }

  .site-title {
    color: #888;
  }

  .nav-container__right {
    background-color: #000;
    border: 1px solid #666;
    color: #e5c53e;
  }
  .nav-container__right:after {
    background-color: #000;
    border: 1px solid #666;
    border-top: 0;
  }

  .page-title {
    color: #888;
  }

  p { 
    color: #888; 
  }

  @keyframes titleFlickr {
    0%   {opacity: 0;}
    50%  {opacity: 1;}
    90%  {opacity: 1;}
    91%  {opacity: 1;}
    92%  {opacity: 0;}
    93%  {opacity: 1;}
    94%  {opacity: 0;}
    95%  {opacity: 1;}
    96%  {opacity: 0;}
    97%  {opacity: 1;}
    98%  {opacity: 0;}
    99%  {opacity: 1;}
    100% {opacity: 1;}
  }

  h3 {
    opacity: 0;
    color: #ccc;
    border-bottom: 4px solid #386664;
    text-shadow: -4px 0 #000, 0px 0 #000, -2px 2px 0 #000, 2px 2px 0 #000;
    animation-name: titleFlickr;
    animation-duration: 8s;
    animation-delay: 1s;
  }

  .romanticism p {
    margin: 0 auto 2rem;
    line-height: 2.5rem;
  }

  .welcomeimagebox {
    display: none;
  }

  .full-bleed {
    margin: 6rem 0 0;
    height: 550px;
  }

  .mapstyle {
    width:100%;
    height: 85vh;
    position:absolute;
    left:0;
  }

  .innershadow {
    position: absolute;
    width: 100%;
    height: 85vh;
    left: 0;
    z-index:999;
    background: linear-gradient(0deg, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 30%, rgba(0,0,0,0) 70%, rgba(0,0,0,1) 100%);
    pointer-events: none;
  }

  .footnotes {
    border-top-color: #555;
  }

  .autopilot-toggle {
    border: 1px solid #555;
    color: #888;
    font-size: 0.9rem;
    border-radius: 10px;
    background-color: rgba(0,0,0,0);
    padding: 0.5rem 1rem;
    transition: all 0.2s;
    cursor: pointer;
    z-index: 1000;
    position: absolute;
    left: 1rem;
    bottom: -3rem;
  }

  .autopilot-toggle:hover {
    border-color: #888;
  }

  .autopilot-toggle:focus {
    outline: none;
  }

  .map-controller {
    position: relative;
    margin-bottom: 0;
    z-index: 1001;
  }

  .happy-auto-pilot {
    position: absolute;
    bottom: 0.5rem;
    opacity: 0;
    pointer-events: none;
    transition: all 1s;
    left: 1rem;
  }

  .autopilot-off:hover .happy-auto-pilot {
    opacity: 1;
  }

  .happy-auto-pilot img {
    width: 120px;
    border: 12px solid black;
    border-radius: 50%;
  }

  .happy-auto-pilot:after {
    content:'';
    position: absolute;
    top: 76%;
    left: 50%;
    margin-left: -50px;f
    width: 0;
    height: 0;
    border-top: solid 50px black;
    border-left: solid 50px transparent;
    border-right: solid 50px transparent;
    z-index: -1;
  }

  ::selection {
    background: rgba(0,0,0,0);
    color: #e5c53e;
  }

  .mapboxgl-ctrl-bottom-right {
    z-index: 1000;
  }

  .mapboxgl-ctrl.mapboxgl-ctrl-attrib {
    background-color: rgba(0,0,0,0);
  }

  .mapboxgl-ctrl-attrib a { color: #666; }
  .mapboxgl-ctrl-attrib a:hover { color: #DDB598; }
  .mapboxgl-ctrl-attrib a:visited { color: #666; }
  .mapboxgl-ctrl-attrib a:active { color: #666; }

  .lit-match {
    margin-bottom: 8rem;
    position: relative;
  }

  .lit-match:after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: radial-gradient(circle, rgba(0,0,0,0) 0%, rgba(0,0,0,0) 10%, rgba(0,0,0,1) 100%);
  }

  .beneathMap {
    margin-top: 10rem;
  }

  .notes {
    border-color: #386664;
  }
</style>

<div class="post-image inline-img black-border lit-match ">
	<fig>
		<img src="/assets/graphics/blank.png" alt="" data-echo="/assets/graphics/posts/15-midnight-arrival/burningmatch.gif" />
	</fig>
	<figcaption>
		
	</figcaption>
</div>

<p>There’s nothing quite as enchanting as an open flame. The wispy spontaneity, the collapsing kindling, &amp; the warmth of a good fire is inescapably captivating.</p>

<p>I think it’s recollection of fire that makes flying at night such a treat. Streetlights flicker &amp; glow like embers. Shooting star car lights slide down invisible roads until they burn out.</p>

<p>When I’m lucky enough to catch the midnight view of a city from on high, I’m usually half soaking the gorgeous view in, and half working on how I could possibly replicate it. This is my attempt to do so.</p>

<p>You can find some tunes to drown out the sound of the engines (or in this case, your computer’s fan) at the top right corner of this page.</p>

<p>Please enjoy this endless descent over Washington D.C.</p>

  </article>
</section>

<div class="post-image post-image__full">
  <div class= "full-bleed">
    <div class="innershadow"></div>
    <div id="nightMap" class="mapstyle"></div>
  </div>
  <div class="map-controller">
    <div class="happy-auto-pilot">
      <img src="../assets/graphics/posts/15-midnight-arrival//airplane_autopilot.png">
    </div>
    <button class="autopilot-toggle autopilot-off">Manual Control</button>
  </div>
</div>

<section class="article-container article-cotainer__within">
  <div class="article-gutter "></div>
  <article class="article-content ">

<script>
  var flightPath = [
   {
     "lon": -77.12232424,
     "lat": 38.93808681,
     "bearing": 90
   },
   {
     "lon": -77.11241137,
     "lat": 38.93633062,
     "bearing": 90
   },
   {
     "lon": -77.10780543,
     "lat": 38.93591592
   },
   {
     "lon": -77.10612657,
     "lat": 38.93579963
   },
   {
     "lon": -77.10147695,
     "lat": 38.93576451
   },
   {
     "lon": -77.09749881,
     "lat": 38.9355759,
   },
   {
     "lon": -77.0912946,
     "lat": 38.93601568
   },
   {
     "lon": -77.08873263,
     "lat": 38.93622082,
     "bearing": 110
   },
   {
     "lon": -77.08735306,
     "lat": 38.93617743,
   },
   {
     "lon": -77.08594427,
     "lat": 38.93605376,
     "bearing": 130
   },
   {
     "lon": -77.08390768,
     "lat": 38.93570399
   },
   {
     "lon": -77.08164471,
     "lat": 38.93498204,
     "bearing": 140
   },
   {
     "lon": -77.07982683,
     "lat": 38.9337344
   },
   {
     "lon": -77.0775491,
     "lat": 38.93247231
   },
   {
     "lon": -77.07221206,
     "lat": 38.92805055,
     "zoom": 15.5
   },
   {
     "lon": -77.06358991,
     "lat": 38.92209692
   },
   {
     "lon": -77.06167699,
     "lat": 38.92033837
   },
   {
     "lon": -77.06053798,
     "lat": 38.91920732,
   },
   {
     "lon": -77.05939896,
     "lat": 38.91807628,
     "zoom": 13.5
   },
   {
     "lon": -77.05853002,
     "lat": 38.91693785
   },
   {
     "lon": -77.05785086,
     "lat": 38.91582127
   },
   {
     "lon": -77.05738333,
     "lat": 38.91453674,
     "bearing": 180
   },
   {
     "lon": -77.05705453,
     "lat": 38.91338356
   },
   {
     "lon": -77.05682047,
     "lat": 38.9117413,
     "zoom": 13
   },
   {
     "lon": -77.05624314,
     "lat": 38.90940572
   },
   {
     "lon": -77.05584822,
     "lat": 38.90682191
   },
   {
     "lon": -77.05540991,
     "lat": 38.90561766,
     "bearing": 120
   },
   {
     "lon": -77.05467231,
     "lat": 38.90434052
   },
   {
     "lon": -77.05313926,
     "lat": 38.90362564,
     "bearing": 80,
     "zoom": 14
   },
   {
     "lon": -77.05147487,
     "lat": 38.90304949
   },
   {
     "lon": -77.04946012,
     "lat": 38.90250995
   },
   {
     "lon": -77.04409445,
     "lat": 38.90000789
   },
   {
     "lon": -77.03418098,
     "lat": 38.89625171
   },
   {
     "lon": -77.02196854,
     "lat": 38.89342321
   },
   {
     "lon": -77.01447891,
     "lat": 38.89133054
   },
   {
     "lon": -77.01196033,
     "lat": 38.8901561
   },
   {
     "lon": -77.01066075,
     "lat": 38.8890835
   },
   {
     "lon": -77.00930273,
     "lat": 38.88785033
   },
   {
     "lon": -77.00826584,
     "lat": 38.88650028
   },
   {
     "lon": -77.00762298,
     "lat": 38.88473405
   },
   {
     "lon": -77.00689955,
     "lat": 38.88199706
   },
   {
     "lon": -77.00608787,
     "lat": 38.87701922
   },
   {
     "lon": -77.00535618,
     "lat": 38.87101217
   },
   {
     "lon": -77.00397602,
     "lat": 38.86896879
   },
   {
     "lon": -77.00236977,
     "lat": 38.86755321
   },
   {
     "lon": -77.00039871,
     "lat": 38.86663409
   },
   {
     "lon": -76.99831844,
     "lat": 38.8666639
   },
   {
     "lon": -76.99358145,
     "lat": 38.86738792
   },
   {
     "lon": -76.98820249,
     "lat": 38.8693457
   },
   {
     "lon": -76.98375092,
     "lat": 38.87260247
   },
   {
     "lon": -76.98167124,
     "lat": 38.87463227
   },
   {
     "lon": -76.98047467,
     "lat": 38.87634064
   },
   {
     "lon": -76.97792126,
     "lat": 38.88081583
   },
   {
     "lon": -76.97693661,
     "lat": 38.88335625
   },
   {
     "lon": -76.97620934,
     "lat": 38.89234912
   },
   {
     "lon": -76.97453107,
     "lat": 38.89423281
   },
   {
     "lon": -76.97191833,
     "lat": 38.89554744
   },
   {
     "lon": -76.96967041,
     "lat": 38.89636562
   },
   {
     "lon": -76.96705767,
     "lat": 38.89768025
   },
   {
     "lon": -76.96553997,
     "lat": 38.89950551
   },
   {
     "lon": -76.96516099,
     "lat": 38.90146181
   },
   {
     "lon": -76.96535166,
     "lat": 38.90448364
   },
   {
     "lon": -76.96666629,
     "lat": 38.90709638
   },
   {
     "lon": -76.96800985,
     "lat": 38.9087894
   },
   {
     "lon": -76.97025836,
     "lat": 38.90997122
   },
   {
     "lon": -76.97533921,
     "lat": 38.91194051
   },
   {
     "lon": -76.98672698,
     "lat": 38.915251
   },
   {
     "lon": -76.99630485,
     "lat": 38.91958392
   },
   {
     "lon": -77.00180896,
     "lat": 38.92121733
   },
   {
     "lon": -77.00429064,
     "lat": 38.92104141
   },
   {
     "lon": -77.00669913,
     "lat": 38.9201648
   },
   {
     "lon": -77.01840568,
     "lat": 38.91535845
   },
   {
     "lon": -77.02098949,
     "lat": 38.91496353
   },
   {
     "lon": -77.02336905,
     "lat": 38.91500662
   },
   {
     "lon": -77.02501899,
     "lat": 38.91604263
   },
   {
     "lon": -77.02588085,
     "lat": 38.91791098
   },
   {
     "lon": -77.02800008,
     "lat": 38.92623148
   },
   {
     "lon": -77.0277421,
     "lat": 38.94250884
   },
   {
     "lon": -77.02856205,
     "lat": 38.95075673
   },
   {
     "lon": -77.03044634,
     "lat": 38.95443499
   },
   {
     "lon": -77.03354195,
     "lat": 38.95694501
   },
   {
     "lon": -77.03708975,
     "lat": 38.95819943
   },
   {
     "lon": -77.04151298,
     "lat": 38.95786236
   },
   {
     "lon": -77.04943974,
     "lat": 38.9571593
   },
   {
     "lon": -77.06049045,
     "lat": 38.95604656
   },
   {
     "lon": -77.06338063,
     "lat": 38.95499461
   },
   {
     "lon": -77.0641687,
     "lat": 38.95416227
   },
   {
     "lon": -77.06551108,
     "lat": 38.95185532
   },
   {
     "lon": -77.06708664,
     "lat": 38.94819064
   },
   {
     "lon": -77.07131743,
     "lat": 38.93883178
   },
   {
     "lon": -77.07176902,
     "lat": 38.93557619
   },
   {
     "lon": -77.07138886,
     "lat": 38.93353251
   },
   {
     "lon": -77.07062912,
     "lat": 38.93144516
   },
   {
     "lon": -77.06824838,
     "lat": 38.92740208
   },
   {
     "lon": -77.06488949,
     "lat": 38.92316952
   }
  ]
</script>

<script>
  mapboxgl.accessToken = 'pk.eyJ1IjoiZ290LW1hcCIsImEiOiJjajVzb2htd2MxYTE5MzNvMHozeTExa3NpIn0.EjAu86Nd3hVJGhcjaxBsYQ';

  var map = new mapboxgl.Map({
    container: 'nightMap',
    style: 'mapbox://styles/got-map/ckh6c58ru1dki19phg4ui2u4u',
    zoom: 13,
    pitch: 45,
    bearing: 60,
    center: [-77.12232423981123, 38.938086813665784],
  });

  var placeInPath = 1
  var curZoom = 15
  var curBearing = 160
  var interval = ''
  var flying = false
  var pilotStatus = true

  map.on('load', function () {
    mapSwitch(false)

    // FLY FUNCTIONS
    map.on('flystart', function(){ flying = true; })
    map.on('flyend', function(){ flying = false; })
    map.on('moveend', function(e){
      if(flying && pilotStatus) {
        map.fire('flyend')
        flyTo()
      }
    })
    flyTo()

    // LIGHTS
    autopilot()
    flicker()
  })

  function flyTo () {
    var flyTarget = flightPath[placeInPath]
    var centerTarget = [flyTarget.lon, flyTarget.lat]

    if (flyTarget.zoom) { curZoom = flyTarget.zoom }
    if (flyTarget.bearing) { curBearing = flyTarget.bearing }

    map.flyTo({
      center: centerTarget,
      zoom: curZoom,
      bearing: curBearing,
      speed: 0.03,
      easing: function (n) {
        return n;
      }
    })
    
    placeInPath++

    map.fire('flystart');
  }

  function autopilot() {
    var pilotToggle = document.querySelector('.autopilot-toggle')
    var controlDef = document.querySelector('.map-controller')

    pilotToggle.addEventListener('click', function() {
      var mapContainer = document.querySelector('.mapstyle')

      if (pilotStatus) {
        pilotToggle.classList.remove('autopilot-on')
        controlDef.classList.remove('autopilot-on')
        pilotToggle.classList.add('autopilot-off')        
        controlDef.classList.add('autopilot-off')

        mapSwitch(true)
        pilotToggle.innerHTML = 'Turn on Autopilot'
        pilotStatus = false

        console.log("this plane is out of control!")
      } else {

        pilotToggle.classList.remove('autopilot-off')
        controlDef.classList.remove('autopilot-off')
        pilotToggle.classList.add('autopilot-on')
        controlDef.classList.add('autopilot-on')

        mapSwitch(false)
        pilotStatus = true
        flyTo()
        pilotToggle.innerHTML = 'Manual Control'

        console.log("oh thank goodness")
      }
    })
  }

  function mapSwitch(value) {
    if(value) {
        map.scrollZoom.enable()
        map.dragPan.enable()
        map.boxZoom.enable()
        map.dragRotate.enable()
        map.keyboard.enable()
        map.doubleClickZoom.enable()
        map.touchZoomRotate.enable({ around: 'center' })
    } else {
        map.scrollZoom.disable()
        map.dragPan.disable()
        map.boxZoom.disable()
        map.dragRotate.disable()
        map.keyboard.disable()
        map.doubleClickZoom.disable()
        map.touchZoomRotate.disable({ around: 'center' })
    }
  }

  function flicker () {
    let max = 35000;
    let r1 = randombetween(1, max-3);
    let r2 = randombetween(1, max-2-r1);
    let r3 = randombetween(1, max-1-r1-r2);
    let r4 = max - r1 - r2 - r3;


    function randombetween(min, max) {
      return Math.floor(Math.random()*(max-min+1)+min);
    }

    setInterval(function() {
      const radiusStops = [70000]
      const radiusStops2 = [70000]
      const radiusStops3 = [70000]
      const radiusValues = []
      const radiusValues2 = []
      const radiusValues3 = []


      for (var i = 6; i >= 0; i--) { radiusStops.push(Math.floor(60000 * Math.random())) }
      for (var i = 6; i >= 0; i--) { radiusStops2.push(Math.floor(60000 * Math.random())) }
      for (var i = 6; i >= 0; i--) { radiusStops3.push(Math.floor(60000 * Math.random())) }

      radiusStops.sort((a, b) => a - b)
      radiusStops2.sort((a, b) => a - b)
      radiusStops3.sort((a, b) => a - b)

      radiusStops.forEach((n) => {
       radiusValues.push(
            [
              n,
              (n === 70000 ? 1 : Math.floor(Math.random() * 100) * 0.01 + 0.75)
            ]
         )
      })

      radiusStops2.forEach((n) => {
       radiusValues2.push(
            [
              n,
              (n === 70000 ? 1 : Math.floor(Math.random() * 100) * 0.01 + 2)
            ]
         )
      })

      radiusStops3.forEach((n) => {
       radiusValues3.push(
            [
              n,
              (n === 70000 ? 1 : Math.floor(Math.random() * 100) * 0.01 + 15)
            ]
         )
      })

      let newRadius = {
        "base": 1,
        "type": "exponential",
        "property": "id",
        "stops": radiusValues
      }

      let newRadius2 = {
        "base": 1,
        "type": "exponential",
        "property": "id",
        "stops": radiusValues2
      }

      let newRadius3 = {
        "base": 1,
        "type": "exponential",
        "property": "id",
        "stops": radiusValues3
      }

      map.setPaintProperty('streetlights-inner-light', 'circle-radius', newRadius)
      map.setPaintProperty('streetlights-glow-1', 'circle-radius', newRadius2)
      map.setPaintProperty('streetlights-glow-2', 'circle-radius', newRadius3)
    }, 500)
  }
</script>

<p class="beneathMap">
  <i>-Dylan, in the clouds<br>
  <span class="post-date">November, 7th 2020</span></i>
</p>

<div class="notes">
  <p><a href="https://dylanmoriarty.github.io/blog/midnight-arrival.html" target="_blank">The first iteration of this project</a> was first published Oct.27, 2017. I decided to revisit it partly as an effort to transition my old blog to this one but mostly due to seeing the wonders <a href="https://twitter.com/jonni_walker" target="_blank">Jonni Walker</a> has been doing w/ firefly styling. Good lord does the 'blur' option help with luminescence! 

  <p>Why D.C.? Well, when I wrote this, I lived there. But it's also a damn well documented city. Most cities don't a readily available shapefile for the cities streetlights. <a href="https://opendata.dc.gov/datasets/6cb6520725b0489d9a209a337818fad1_90" target="_blank">D.C. sure does!</a></p>

  <p>The building data here is from <a href="opendata.dc.gov" target="_blank">opendata.dc.gov</a>, and is wildly more detailed than I had use for. 3D modelers rejoyce. That data was simplified via <a href="https://github.com/mbloch/mapshaper/wiki/Command-Reference" target="_blank">Mapshaper</a> and worked into mbtiles with <a href="https://github.com/mapbox/tippecanoe" target="_blank">Tippecanoe</a>. The later allows more custom control with how tiles are rendered from geojson's.</p>

  <p>The match GIF came from Giphy, no idea where they got it from unfortunately.</p>

  <p>I'd pondered for awhile how I could generate streetlight-esque patterns through manipulating road layers:</p>

  <p>In one iteration I was going to make 'fake' streetlights by using road lines but making them 'dotted'; 1 pixel dashes with 10 pixel gaps between them or so. This would allow us to get lights for the whole world, but is terribly unruly and turns into a disaster when there are nearby roads. It also adds a uniformity that no human urban planner could dream to achieve.</p>

  <p>Another was to generate millions of random points in QGIS, & then clip it to buffered roads. Never tried this because I thought, again, a random distribution would look unrealistic. Streetlights do have SOME regions of uniformity. Also, too much work. This is play, dammit.</p>

  <p>Finally, I apologize to your eyeballs for making an incredibly dark webpage on a site where otherwise every page is a very light grey. Sorry eyeballs!</p>
</div>



    <div class = "article-foot">
        <div class="article-back"><a href="../" class="no_underline">&larr; Home</a></div>
    </div>

  </article>
</section>

<script>
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
      define(function() {
        return factory(root);
      });
    } else if (typeof exports === 'object') {
      module.exports = factory;
    } else {
      root.echo = factory(root);
    }
  })(this, function (root) {
  
    'use strict';
  
    var echo = {};
  
    var callback = function () {};
  
    var offset, poll, delay, useDebounce, unload;
  
    var isHidden = function (element) {
      return (element.offsetParent === null);
    };
    
    var inView = function (element, view) {
      if (isHidden(element)) {
        return false;
      }
  
      var box = element.getBoundingClientRect();
      return (box.right >= view.l && box.bottom >= view.t && box.left <= view.r && box.top <= view.b);
    };
  
    var debounceOrThrottle = function () {
      if(!useDebounce && !!poll) {
        return;
      }
      clearTimeout(poll);
      poll = setTimeout(function(){
        echo.render();
        poll = null;
      }, delay);
    };
  
    echo.init = function (opts) {
      opts = opts || {};
      var offsetAll = opts.offset || 0;
      var offsetVertical = opts.offsetVertical || offsetAll;
      var offsetHorizontal = opts.offsetHorizontal || offsetAll;
      var optionToInt = function (opt, fallback) {
        return parseInt(opt || fallback, 10);
      };
      offset = {
        t: optionToInt(opts.offsetTop, offsetVertical),
        b: optionToInt(opts.offsetBottom, offsetVertical),
        l: optionToInt(opts.offsetLeft, offsetHorizontal),
        r: optionToInt(opts.offsetRight, offsetHorizontal)
      };
      delay = optionToInt(opts.throttle, 250);
      useDebounce = opts.debounce !== false;
      unload = !!opts.unload;
      callback = opts.callback || callback;
      echo.render();
      if (document.addEventListener) {
        root.addEventListener('scroll', debounceOrThrottle, false);
        root.addEventListener('load', debounceOrThrottle, false);
      } else {
        root.attachEvent('onscroll', debounceOrThrottle);
        root.attachEvent('onload', debounceOrThrottle);
      }
    };
  
    echo.render = function (context) {
      var nodes = (context || document).querySelectorAll('[data-echo], [data-echo-background]');
      var length = nodes.length;
      var src, elem;
      var view = {
        l: 0 - offset.l,
        t: 0 - offset.t,
        b: (root.innerHeight || document.documentElement.clientHeight) + offset.b,
        r: (root.innerWidth || document.documentElement.clientWidth) + offset.r
      };
      for (var i = 0; i < length; i++) {
        elem = nodes[i];
        if (inView(elem, view)) {
  
          if (unload) {
            elem.setAttribute('data-echo-placeholder', elem.src);
          }
  
          if (elem.getAttribute('data-echo-background') !== null) {
            elem.style.backgroundImage = 'url(' + elem.getAttribute('data-echo-background') + ')';
          }
          else if (elem.src !== (src = elem.getAttribute('data-echo'))) {
            elem.src = src;
          }
  
          if (!unload) {
            elem.removeAttribute('data-echo');
            elem.removeAttribute('data-echo-background');
          }
  
          callback(elem, 'load');
        }
        else if (unload && !!(src = elem.getAttribute('data-echo-placeholder'))) {
  
          if (elem.getAttribute('data-echo-background') !== null) {
            elem.style.backgroundImage = 'url(' + src + ')';
          }
          else {
            elem.src = src;
          }
  
          elem.removeAttribute('data-echo-placeholder');
          callback(elem, 'unload');
        }
      }
      if (!length) {
        echo.detach();
      }
    };
  
    echo.detach = function () {
      if (document.removeEventListener) {
        root.removeEventListener('scroll', debounceOrThrottle);
      } else {
        root.detachEvent('onscroll', debounceOrThrottle);
      }
      clearTimeout(poll);
    };
  
    return echo;
  
  });
</script>
<script>
    echo.init({
      offset: 2500,
      throttle: 250,
      unload: false,
      callback: function (element, op) {
        //console.log(element, 'has been', op + 'ed')
      }
    });
</script>


</div>

<footer id="footer">
	<div class="centerme">©2022 <a target="_blank" href="https://twitter.com/DylanMoriarty">Dylan Moriarty</a></div>
</footer>

<script src="/assets/scripts/vendor-0d6388c26b.js"></script>
<script src="/assets/scripts/bundle-337d45c1b4.js"></script>
